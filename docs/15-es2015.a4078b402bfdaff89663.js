(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Mo3u:function(l,n,e){"use strict";e.r(n);var t=e("8Y7J");class o{}var u=e("pMnS"),r=e("oBZk"),a=e("ZZ/e"),i=e("s7LF"),s=e("SVse");class c{transform(l,...n){if(!l)return"0";const e=l.toString().split("").reverse().join("");let t="",o=1;for(const u of e)t=u+t,o%3==0&&o<e.length&&(t="."+t),o++;return t}}var b=e("mrSG"),p=e("EnSQ"),d=e("RANn");class g{constructor(l,n,e){this.dataService=l,this.navService=n,this.route=e,this.scores=[],this.shouldScroll=!0,this.isSecondRun=!1}createNewRound(){return b.b(this,void 0,void 0,(function*(){this.newRound&&(this.game.rounds.push(this.newRound.id),yield this.dataService.saveRound(this.newRound),yield this.dataService.saveGame(this.game));const l=this.rounds.length,n={};for(const e of this.game.players)n[e]=0;this.newRound=this.dataService.createNewRound("round "+l,l,n),this.rounds.push(this.newRound)}))}ngAfterContentChecked(){this.scrollToBottom()}ngAfterViewChecked(){this.scrollToBottom()}ngOnInit(){return b.b(this,void 0,void 0,(function*(){const l=this.route.snapshot.paramMap.get("id");this.game=this.dataService.getGame(l),this.gameType=this.dataService.getGameType(this.game.type),this.players=[],this.rounds=[];for(const n of this.game.players){const l=this.dataService.getPlayer(n);this.players.push(l)}for(const n of this.game.rounds){const l=this.dataService.getRound(n);this.rounds.push(l)}yield this.createNewRound(),this.calculateScores()}))}onValueChanged(l,n,e){return b.b(this,void 0,void 0,(function*(){const t=Number.parseInt(l.target.value,0)||0;n.values[e.id]=t,n===this.newRound&&0!==t&&(yield this.createNewRound()),yield this.dataService.saveRounds();const o=Date.now();for(const l of this.game.players){const n=this.dataService.getPlayer(l);n.lastPlayed=o,yield this.dataService.savePlayer(n)}this.game.updated=o,yield this.dataService.saveGame(this.game),this.calculateScores()}))}calculateScores(){for(const l of this.game.players){let n=0;for(const e of this.rounds)n+=e.values[l]||0;this.scores[l]=n}}onKeyPressed(l){"Enter"===l.code&&l.target.blur()}onScroll(l){const n=l.target.scrollLeft;this.data.nativeElement.scrollLeft=n,this.header.nativeElement.scrollLeft=n,this.footer.nativeElement.scrollLeft=n}getValue(l,n){return l.values[n.id]}scrollToBottom(){if(this.data&&this.shouldScroll){const l=this.data.nativeElement;l.scrollHeight-l.scrollTop-l.clientHeight==0||(l.scrollTop=l.scrollHeight-l.clientHeight,this.isSecondRun&&(this.shouldScroll=!1,this.isSecondRun=!1),this.isSecondRun=!0)}}endGame(){return b.b(this,void 0,void 0,(function*(){this.game.ended=!this.game.ended,this.getResult().forEach((l,n)=>{l.openCount+=this.game.ended?-1:1,0===n?l.winCount+=this.game.ended?1:-1:l.looseCount+=this.game.ended?1:-1}),yield this.dataService.savePlayers(),yield this.dataService.saveGame(this.game)}))}getResult(){if(this.players&&this.gameType){const l=[];return l.push(...this.players),l.sort(this.gameType.winHigh?(l,n)=>this.scores[n.id]-this.scores[l.id]:(l,n)=>this.scores[l.id]-this.scores[n.id])}return[]}getWinner(){return this.getResult().find(()=>!0)}goBack(){return b.b(this,void 0,void 0,(function*(){yield this.navService.goBack()}))}}var h=e("iInd"),f=t.ob({encapsulation:0,styles:[["[_nghost-%COMP%]   .scroll-client-wrapper[_ngcontent-%COMP%], [_nghost-%COMP%]   .scroll-master-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:nowrap;overflow:hidden;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]   .scroll-client-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, [_nghost-%COMP%]   .scroll-master-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}[_nghost-%COMP%]   .scroll-master-wrapper[_ngcontent-%COMP%]{overflow:auto;flex-direction:column}[_nghost-%COMP%]   .scroll-client-wrapper[_ngcontent-%COMP%]{overflow-x:auto}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-data[_ngcontent-%COMP%]{max-height:calc(100% - 64px - 64px)}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;align-items:center;flex:0 0 auto;height:64px;line-height:64px;font-size:1.2rem;border-bottom:1px solid #2b2b2b}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row.table-row-header[_ngcontent-%COMP%]{height:64px;line-height:64px;font-size:1.2rem;font-weight:700;background-color:#515355}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row.table-row-footer[_ngcontent-%COMP%]{height:64px;line-height:64px;font-size:1.2rem;font-weight:700;background-color:#515355}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row.table-row-data[_ngcontent-%COMP%]:nth-child(2n){background-color:#2b2b2b}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row.table-row-data[_ngcontent-%COMP%]:nth-child(2n-1){background-color:#3c3f41}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{background-color:inherit;line-height:inherit;border-top:1px solid #2b2b2b;border-left:1px solid #2b2b2b;border-right:none;border-bottom:none;text-align:center;white-space:nowrap;text-overflow:ellipsis;flex:1 0 100px}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]:last-child{border-right:1px solid #2b2b2b}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-top:0;--padding-end:0;--padding-bottom:0;--padding-start:0}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   .table-cell.table-cell-header[_ngcontent-%COMP%]{height:64px}[_nghost-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   .table-cell.table-cell-round[_ngcontent-%COMP%]{flex:0 0 2rem}[_nghost-%COMP%]   .result-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between}[_nghost-%COMP%]   .result-row[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.2rem;line-height:1.2rem;display:block}[_nghost-%COMP%]   .result-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:0 0 50%}[_nghost-%COMP%]   .result-row[_ngcontent-%COMP%]   span.score[_ngcontent-%COMP%]{text-align:right}"]],data:{}});function m(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,6,"ion-buttons",[["slot","end"]],null,null,null,r.D,r.c)),t.pb(1,49152,null,0,a.j,[t.h,t.k,t.x],null,null),(l()(),t.Hb(2,0,[" "," "])),(l()(),t.qb(3,0,null,0,3,"ion-button",[],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.endGame()&&t),t}),r.C,r.b)),t.pb(4,49152,null,0,a.i,[t.h,t.k,t.x],null,null),(l()(),t.qb(5,0,null,0,1,"ion-icon",[["color","warning"],["slot","icon-only"]],null,null,null,r.H,r.g)),t.pb(6,49152,null,0,a.A,[t.h,t.k,t.x],{color:[0,"color"],name:[1,"name"]},null)],(function(l,n){l(n,6,0,"warning",n.component.game.ended?"play":"square")}),(function(l,n){l(n,2,0,n.component.game.ended?"Weiter":"Beenden")}))}function w(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,1,"div",[["class","table-cell table-cell-header"]],null,null,null,null,null)),(l()(),t.Hb(1,null,["",""]))],null,(function(l,n){l(n,1,0,n.context.$implicit.name)}))}function v(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,4,"div",[["class","table-cell table-cell-data table-cell-edit"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,3,"ion-input",[["type","number"]],null,[[null,"ionBlur"],[null,"keyup"],[null,"ionChange"]],(function(l,n,e){var o=!0,u=l.component;return"ionBlur"===n&&(o=!1!==t.Bb(l,4)._handleBlurEvent(e.target)&&o),"ionChange"===n&&(o=!1!==t.Bb(l,4)._handleIonChange(e.target)&&o),"ionBlur"===n&&(o=!1!==u.onValueChanged(e,l.parent.context.$implicit,l.context.$implicit)&&o),"keyup"===n&&(o=!1!==u.onKeyPressed(e)&&o),o}),r.I,r.h)),t.Eb(5120,null,i.b,(function(l){return[l]}),[a.Gb]),t.pb(3,49152,null,0,a.E,[t.h,t.k,t.x],{type:[0,"type"],value:[1,"value"]},null),t.pb(4,16384,null,0,a.Gb,[t.k],null,null)],(function(l,n){l(n,3,0,"number",n.component.getValue(n.parent.context.$implicit,n.context.$implicit))}),null)}function C(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,4,"div",[["class","table-row table-row-data"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,1,"div",[["class","table-cell table-cell-data table-cell-round"]],null,null,null,null,null)),(l()(),t.Hb(2,null,["",""])),(l()(),t.fb(16777216,null,null,1,null,v)),t.pb(4,278528,null,0,s.i,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){l(n,4,0,n.component.players)}),(function(l,n){l(n,2,0,n.context.$implicit.idx)}))}function O(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,2,"div",[["class","table-cell table-cell-footer"]],null,null,null,null,null)),(l()(),t.Hb(1,null,["",""])),t.Db(2,1)],null,(function(l,n){var e=n.component,o=t.Ib(n,1,0,l(n,2,0,t.Bb(n.parent.parent,0),e.scores[n.context.$implicit.id]));l(n,1,0,o)}))}function P(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,13,"div",[["class","table-wrapper"]],null,null,null,null,null)),(l()(),t.qb(1,0,[[1,0],["header",1]],null,4,"div",[["class","table-row table-row-header scroll-client-wrapper"]],null,[[null,"scroll"]],(function(l,n,e){var t=!0;return"scroll"===n&&(t=!1!==l.component.onScroll(e)&&t),t}),null,null)),(l()(),t.qb(2,0,null,null,1,"div",[["class","table-cell table-cell-header table-cell-round"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["#"])),(l()(),t.fb(16777216,null,null,1,null,w)),t.pb(5,278528,null,0,s.i,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null),(l()(),t.qb(6,0,[[3,0],["data",1]],null,2,"div",[["class","table-data scroll-master-wrapper"]],null,[[null,"scroll"]],(function(l,n,e){var t=!0;return"scroll"===n&&(t=!1!==l.component.onScroll(e)&&t),t}),null,null)),(l()(),t.fb(16777216,null,null,1,null,C)),t.pb(8,278528,null,0,s.i,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null),(l()(),t.qb(9,0,[[2,0],["footer",1]],null,4,"div",[["class","table-row table-row-footer scroll-client-wrapper"]],null,[[null,"scroll"]],(function(l,n,e){var t=!0;return"scroll"===n&&(t=!1!==l.component.onScroll(e)&&t),t}),null,null)),(l()(),t.qb(10,0,null,null,1,"div",[["class","table-cell table-cell-footer table-cell-round"]],null,null,null,null,null)),(l()(),t.Hb(-1,null,["\u2211"])),(l()(),t.fb(16777216,null,null,1,null,O)),t.pb(13,278528,null,0,s.i,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,5,0,e.players),l(n,8,0,e.rounds),l(n,13,0,e.players)}),null)}function M(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,7,"p",[["class","result-row"]],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,3,"span",[],null,null,null,null,null)),(l()(),t.qb(2,0,null,null,1,"strong",[["class","title"]],null,null,null,null,null)),(l()(),t.Hb(3,null,["",""])),(l()(),t.Hb(-1,null,[" hat gewonnen"])),(l()(),t.qb(5,0,null,null,2,"span",[["class","score"]],null,null,null,null,null)),(l()(),t.Hb(6,null,[""," Punkte"])),t.Db(7,1)],null,(function(l,n){var e=n.component;l(n,3,0,n.context.$implicit.name);var o=t.Ib(n,6,0,l(n,7,0,t.Bb(n.parent.parent,0),e.scores[n.context.$implicit.id]));l(n,6,0,o)}))}function _(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,5,null,null,null,null,null,null,null)),(l()(),t.qb(1,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),t.Hb(2,null,["",". ",""])),(l()(),t.qb(3,0,null,null,2,"span",[["class","score"]],null,null,null,null,null)),(l()(),t.Hb(4,null,[""," Punkte"])),t.Db(5,1)],null,(function(l,n){var e=n.component;l(n,2,0,n.parent.context.index+1,n.parent.context.$implicit.name);var o=t.Ib(n,4,0,l(n,5,0,t.Bb(n.parent.parent.parent,0),e.scores[n.parent.context.$implicit.id]));l(n,4,0,o)}))}function x(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,2,"p",[["class","result-row"]],null,null,null,null,null)),(l()(),t.fb(16777216,null,null,1,null,_)),t.pb(2,16384,null,0,s.j,[t.L,t.I],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,2,0,0!==n.context.index)}),null)}function y(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,8,"div",[],null,null,null,null,null)),(l()(),t.qb(1,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),t.Hb(-1,null,["Das Spiel ist beendet."])),(l()(),t.fb(16777216,null,null,1,null,M)),t.pb(4,16384,null,0,s.j,[t.L,t.I],{ngIf:[0,"ngIf"]},null),(l()(),t.qb(5,0,null,null,1,"div",[["flex-center-center",""],["flex-row",""],["style","min-height: 238px;"]],null,null,null,null,null)),(l()(),t.qb(6,0,null,null,0,"img",[["alt","winner gify"],["src","/assets/winner.gif"]],null,null,null,null,null)),(l()(),t.fb(16777216,null,null,1,null,x)),t.pb(8,278528,null,0,s.i,[t.L,t.I,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,4,0,e.getWinner()),l(n,8,0,e.getResult())}),null)}function k(l){return t.Jb(0,[t.Cb(0,c,[]),t.Fb(671088640,1,{header:0}),t.Fb(671088640,2,{footer:0}),t.Fb(671088640,3,{data:0}),(l()(),t.qb(4,0,null,null,12,"ion-header",[],null,null,null,r.G,r.f)),t.pb(5,49152,null,0,a.z,[t.h,t.k,t.x],null,null),(l()(),t.qb(6,0,null,0,10,"ion-toolbar",[],null,null,null,r.bb,r.A)),t.pb(7,49152,null,0,a.Ab,[t.h,t.k,t.x],null,null),(l()(),t.qb(8,0,null,0,3,"ion-button",[["fill","none"],["slot","start"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.goBack()&&t),t}),r.C,r.b)),t.pb(9,49152,null,0,a.i,[t.h,t.k,t.x],{fill:[0,"fill"]},null),(l()(),t.qb(10,0,null,0,1,"ion-icon",[["name","arrow-round-back"],["slot","icon-only"]],null,null,null,r.H,r.g)),t.pb(11,49152,null,0,a.A,[t.h,t.k,t.x],{name:[0,"name"]},null),(l()(),t.qb(12,0,null,0,2,"ion-title",[],null,null,null,r.Z,r.y)),t.pb(13,49152,null,0,a.yb,[t.h,t.k,t.x],null,null),(l()(),t.Hb(14,0,["",""])),(l()(),t.fb(16777216,null,0,1,null,m)),t.pb(16,16384,null,0,s.j,[t.L,t.I],{ngIf:[0,"ngIf"]},null),(l()(),t.qb(17,0,null,null,5,"ion-content",[["class","ion-padding"]],null,null,null,r.F,r.e)),t.pb(18,49152,null,0,a.s,[t.h,t.k,t.x],null,null),(l()(),t.fb(16777216,null,0,1,null,P)),t.pb(20,16384,null,0,s.j,[t.L,t.I],{ngIf:[0,"ngIf"]},null),(l()(),t.fb(16777216,null,0,1,null,y)),t.pb(22,16384,null,0,s.j,[t.L,t.I],{ngIf:[0,"ngIf"]},null)],(function(l,n){var e=n.component;l(n,9,0,"none"),l(n,11,0,"arrow-round-back"),l(n,16,0,e.game),l(n,20,0,e.game&&!e.game.ended),l(n,22,0,e.game&&e.game.ended)}),(function(l,n){var e=n.component;l(n,14,0,null==e.game?null:e.game.name)}))}function q(l){return t.Jb(0,[(l()(),t.qb(0,0,null,null,1,"app-game",[],null,null,null,k,f)),t.pb(1,10600448,null,0,g,[p.a,d.a,h.a],null,null)],(function(l,n){l(n,1,0)}),null)}var S=t.mb("app-game",g,q,{},{},[]),I=e("Vu57"),R=e("O2lF"),z=e("uk9C"),H=e("zsqI"),B=e("2nQl"),F=e("6WaA");class J{}var L=e("j1ZV");e.d(n,"GamePageModuleNgFactory",(function(){return j}));var j=t.nb(o,[],(function(l){return t.yb([t.zb(512,t.j,t.Y,[[8,[u.a,S,I.a,R.a,z.a,H.a,B.a]],[3,t.j],t.v]),t.zb(4608,s.l,s.k,[t.s,[2,s.r]]),t.zb(4608,i.g,i.g,[]),t.zb(4608,a.a,a.a,[t.x,t.g]),t.zb(4608,a.Eb,a.Eb,[a.a,t.j,t.p]),t.zb(4608,a.Ib,a.Ib,[a.a,t.j,t.p]),t.zb(1073742336,s.b,s.b,[]),t.zb(1073742336,i.f,i.f,[]),t.zb(1073742336,i.a,i.a,[]),t.zb(1073742336,a.Cb,a.Cb,[]),t.zb(1073742336,h.n,h.n,[[2,h.s],[2,h.m]]),t.zb(1073742336,J,J,[]),t.zb(1073742336,L.a,L.a,[]),t.zb(1073742336,o,o,[]),t.zb(1024,h.k,(function(){return[[{path:"",component:g,canActivate:[F.a]}]]}),[])])}))}}]);